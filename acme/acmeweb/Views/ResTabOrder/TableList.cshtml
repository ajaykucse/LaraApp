<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="~/Images/acmelogo.ico" />
    <meta name="description" content="The acme Online ERP Solution for your businesses. You can get Dashboard,Finance,Inventory,Accounting,Purchase and Sales management and many more modules and features.">
    <meta name="keywords" content="Accounting software in Nepal,Best Accounting software,Accounting software,Online Accounting software,ERP,ERP in Nepal, Best ERP in nepal,Dashboard,Finance,Inventory,Accounting,Purchase and Sales management">
    <title>ACME|Accounting Software</title>
    <script type='text/javascript' src='~/Scripts/jquery-3.3.1.min.js'></script>
    <script type="text/javascript" src="~/Scripts/bootstrap.min.js"></script>
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <style type="text/css">
    .flexbox-parent {width: 100%;height: 100%;display: flex;flex-direction: column;justify-content: flex-start;/* align items in Main Axis */align-items: stretch;/* align items in Cross Axis */align-content: stretch;/* Extra space in Cross Axis */background: rgba(255, 255, 255, .1);}
    .flexbox-item {padding: 5px;}
    .flexbox-item-grow {flex: 1; /* same as flex: 1 1 auto; */}
    .fill-area {display: flex;flex-direction: row;justify-content: flex-start;/* align items in Main Axis */align-items: stretch;/* align items in Cross Axis */align-content: stretch;/* Extra space in Cross Axis */}
    .fill-area-content {overflow: hidden;}
    .panel-heading {padding: 10px;}
    .panel-body {/* height: 480px; */height: calc(100vh - 200px);overflow-y: auto;padding: 10px;}
    .panel-body .btn{margin:5px; min-width:83px; padding:6px 10px; }
    .panel-footer {padding: 10px;}
    .radio-group {position: relative;}
    .radio {display: inline-block;background-color: #dedede;cursor: pointer;padding: 6px;}
    .radio.selected {border-color: #4d565f;background: #4d565f;color: #fff;}
    .btn-group .btn{margin-top:0px;min-width:45px;}
    .media-meta {font-size: 11px;color: #bdbaba;border: 1px solid #bdbaba;padding: 1px 3px;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px;font-weight:normal;}
    .round {display: inline-block;height: 30px;width: 30px;line-height: 30px;-moz-border-radius: 15px;border-radius: 15px;background-color: #222;color: #FFF;text-align: center;}
    .round.hollow {display: inline-block;height: 30px;width: 30px;line-height: 30px;-moz-border-radius: 15px;border-radius: 15px;background-color: #FFF;color: #222;text-align: center;-webkit-box-shadow: 0px 0px 0px 1px rgba(0,0,0,0.75);-moz-box-shadow: 0px 0px 0px 1px rgba(0,0,0,0.75);box-shadow: 0px 0px 0px 1px rgba(0,0,0,0.75);}

            .round.round-sm {
                height: 20px;
                width: 20px;
                line-height: 20px;
                -moz-border-radius: 10px;
                border-radius: 10px;
                font-size: 0.7em;
                margin:5px;
            }

            .round.round-lg {
                height: 40px;
                width: 40px;
                line-height: 40px;
                -moz-border-radius: 20px;
                border-radius: 20px;
                font-size: 1.5em;
            }

            .round.blue {
                background-color: #3EA6CE;
            }

            .round.orange {
                background-color: #FF6701;
            }

           
            .round.hollow.blue {
                color: #3EA6CE;
                background-color: #FFF;
                -webkit-box-shadow: 0px 0px 0px 1px #3EA6CE;
                -moz-box-shadow: 0px 0px 0px 1px #3EA6CE;
                box-shadow: 0px 0px 0px 1px #3EA6CE;
            }

            .round.hollow.orange {
                color: #FF6701;
                background-color: #FFF;
                -webkit-box-shadow: 0px 0px 0px 1px #FF6701;
                -moz-box-shadow: 0px 0px 0px 1px #FF6701;
                box-shadow: 0px 0px 0px 1px #FF6701;
            }

        .close {
            border: none;
            border-radius: 5px;
            color: #000;
            cursor: pointer;
            font-size: 25px;
        }
        button.close{background:orange; padding:0px 8px; opacity:100;text-shadow:none;font-weight:normal;}
        .list-group-item{padding: 8px 10px 3px 10px;font-size:12px;}
        .modal-header{padding:5px;}
        


    </style>
</head>
<body>
    <div class="flexbox-parent">
        <div class="flexbox-item fill-area content flexbox-item-grow">
            <div class="fill-area-content flexbox-item-grow">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="panel panel-default">
                            <div class="panel-heading tblfilter-group">
                                <div class="btn-group">
                                    <button type="button" class="btn radio btn-default selected" data-value="All">All</button>
                                    <button type="button" class="btn radio btn-default" data-value="Available">Available</button>
                                    <button type="button" class="btn radio btn-default" data-value="Occupied">Occupied</button>
                                    <button type="button" class="btn radio btn-default" data-value="Dining">Dining</button>
                                    <button type="button" class="btn radio btn-default" data-value="Pack">Pack</button>
                                    <div class="btn-group pull-right">
                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span>User <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a href="/opencompany/exit">LOGOUT</a></li>
                                            <li><a href="/opencompany/exit">REPORT</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="panel-body"></div>
                            <footer class="panel-footer floor-group">
                                <div class="btn-group floorlisting">
                                    <button type="button" class="btn radio btn-default selected" data-value="All">All</button>
                                </div>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Start -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog" style="width:100%; margin:0px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <input type="button" class="btn btn-default btn-my" id="btnMergeTable" value="Merge">
                    <input type="button" class="btn btn-default btn-my" id="btnTransferTable" value="Transfer">
                    <input type="button" class="btn btn-default btn-my" id="PrintOrder" value="Print Order">
                    <input type="button" class="btn btn-default btn-my" id="PrintKOT" value="Print KOT">
                </div>
                <div class="modal-body" style="padding-top:5px;">
                    <div class="row">
                        <div class="col-md-5 col-xs-5" style="padding-right:0px; padding-left:5px;">
                            <table class="table table-striped table-bordered" style="font-size:12px;">
                                <thead>
                                    <tr>
                                        <td><strong>Items</strong> </td>
                                        <td><strong>Qty</strong> </td>
                                        <td><strong>#</strong> </td>
                                    </tr>
                                </thead>
                                <tbody id="tbodyproduct"></tbody>
                            </table>
                        </div>
                        <div class="col-md-7 col-xs-7" style="padding-right:5px; padding-left:5px;">
                            <div class="input-group add-on">
                                <input type="text" placeholder="Search" class="form-control" id="txtSearchProduct">
                                <div class="input-group-btn">
                                    <button class="btn btn-default" type="submit" id="btnSearchClear" style="border-radius:0px; color:#d46618">
                                        <i class="glyphicon glyphicon-arrow-left"></i>
                                    </button>
                                </div>
                                <div class="input-group-btn">
                                    <button class="btn btn-default" type="submit" id="btnSearchButton">
                                        <i class="glyphicon glyphicon-search"></i>
                                    </button>
                                </div>
                            </div>
                            <ul class="list-group"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal End -->

    <script type="text/javascript">
        $(document).ready(function () {
            $.fn.widest = function () {
                return this.length ? this.width(Math.max.apply(Math, this.map(function () {
                    return $(this).width();
                }))) : this;
            };
            $.ajax({
                url: "/ResTabOrder/TableListing",
                datatype: "json",
                data: {
                    TableStatus: 'O',
                    FloorId: '0'
                },
                type: "post",
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (data) {
                    if (data.length > 0) {
                        var cols = '';
                        for (var i = 0; i < data.length; i++) {
                            var cls = data[i]['TableStatus'] == 'O' ? 'class="btn btn-danger"' : 'class="btn btn-success"';
                            cols += "<button type=\"button\" " + cls + " data-value=" + data[i]['TableId'] + " data-TableType=" + data[i]['TableType'] + " data-FloorId=" + data[i]['FloorId'] + " data-tablestatus=" + data[i]['TableStatus'] + " data-toggle=\"modal\" data-target=\"#myModal\">" + data[i]['TableDesc'] + "</button>";
                        }
                        $(".panel-body").append(cols);
                        $('.panel-body .btn').widest();
                    }
                },
                error: function (xhr) {
                    alert('Error occurred during table listing');
                }
            });
            $.ajax({
                url: "/ResTabOrder/FloorListing",
                datatype: "json",
                data: {
                },
                type: "post",
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (data) {
                    if (data.length > 0) {
                        var cols = '';
                        for (var i = 0; i < data.length; i++) {
                            cols += "<button type=\"button\" class=\"btn radio btn-default\" data-value=" + data[i]['FloorId'] + ">" + data[i]['FloorDesc'] + "</button>";
                        }
                        $(".floorlisting").append(cols);
                    }
                },
                error: function (xhr) {
                    alert('Error occurred during floor listing');
                }
            });
            $.ajax({
                url: "/ResTabOrder/ProductList",
                datatype: "json",
                data: {
                },
                type: "post",
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (data) {
                    if (data.length > 0) {
                        var cols = '';
                        for (var i = 0; i < data.length; i++) {
                            cols += '<li class="list-group-item">' + data[i]['ProductDesc'] + ' <label class="media-meta">Rs. ' + data[i]['SalesRate'] +'</label> <div class="round round-sm hollow orange pull-right" style="margin:0px;"><span class="glyphicon glyphicon-plus"></span></div></li>';
                        }
                        $(".list-group").append(cols);
                    }
                },
                error: function (xhr) {
                    alert('Error occurred during floor listing');
                }
            });
            $('#txtSearchProduct').keyup(function () {
                var current_query = $('#txtSearchProduct').val().toLowerCase();
                if (current_query !== "") {
                    $(".list-group li").hide();
                    $(".list-group li").each(function () {
                        var current_keyword = $(this).text().toLowerCase();
                        if (current_keyword.indexOf(current_query) >= 0) {
                            $(this).show();
                        };
                    });
                } else {
                    $(".list-group li").show();
                };
            });
        });

        $('body').on('click', ".panel-body button", function (e) {
            //window.location.href = "/RestaurantOrder/TakeOrder?TableId=" + $(this).attr('id');
            //var val = $(this).attr('data-value');
            //var val = $(this).attr('data-tablestatus');
            //alert(val);
            $("#tbodyproduct").empty();
            $.ajax({
                url: "/ResTabOrder/GetSalesOrderByVoucherTableId",
                datatype: "json",
                data: {
                    TableId: $(this).attr('data-value')
                },
                type: "post",
                contenttype: 'application/json; charset=utf-8',
                async: true,
                success: function (data) {
                    if (data.length > 0) {
                        var _qty = 0;
                        for (var i = 0; i < data[0].Details.length; i++) {
                            _qty = Number(_qty) + Number(data[0].Details[i].Qty);
                            var cols = '<tr><td>' + data[0].Details[i].ProductDesc + '</td><td>' + data[0].Details[i].Qty + '</td><td><div class="round round-sm hollow blue"><span class="glyphicon glyphicon-menu-hamburger"></span></div><div class="round round-sm hollow orange"><span class="glyphicon glyphicon-trash"></span></div></td></tr>';
                            $("#tbodyproduct").append(cols);
                        }
                        var cols = '<tr><td colspan="1" style="text-align:right"><strong>Total Qty</strong></td><td colspan="2"><strong>' + _qty + '</strong></td></tr>';
                        $("#tbodyproduct").append(cols);
                    }
                    else {
                        for (var i = 0; i < 5; i++) {
                            var cols = '<tr><td></td><td></td><td>&nbsp;</td></tr>';
                            $("#tbodyproduct").append(cols);
                        }

                    }
                },
                error: function (xhr) {
                    alert('Error occurred during GetSalesOrderByVoucherTableId');
                }
            });
        });

        $('body').on('click', ".tblfilter-group .radio", function (e) {
            $(this).parent().find('.radio').removeClass('selected');
            $(this).addClass('selected');
            if ($(this).attr('data-value') === 'Available') {
                $(".panel-body button").hide();
                $(".panel-body button").each(function () {
                    if ($(this).attr('data-tablestatus') === 'A') {
                        $(this).show();
                    }
                });
            }
            else if ($(this).attr('data-value') === 'Occupied') {
                $(".panel-body button").hide();
                $(".panel-body button").each(function () {
                    if ($(this).attr('data-tablestatus') === 'O') {
                        $(this).show();
                    }
                });
            }
            else if ($(this).attr('data-value') === 'Dining') {
                $(".panel-body button").hide();
                $(".panel-body button").each(function () {
                    if ($(this).attr('data-tabletype') === 'Dining') {
                        $(this).show();
                    }
                });
            }
            else if ($(this).attr('data-value') === 'Pack') {
                $(".panel-body button").hide();
                $(".panel-body button").each(function () {
                    if ($(this).attr('data-tabletype') === 'Packing') {
                        $(this).show();
                    }
                });
            }
            else if ($(this).attr('data-value') === 'All') {
                $(".panel-body button").show();
            }
        });

        $('body').on('click', ".floor-group .radio", function (e) {
            $(this).parent().find('.radio').removeClass('selected');
            $(this).addClass('selected');
            var val = $(this).attr('data-value');
            if ($(this).attr('data-value') === 'All') {
                $(".panel-body button").show();
            }
            else {
                $(".panel-body button").hide();
                $(".panel-body button").each(function () {
                    if ($(this).attr('data-floorid') === val) {
                        $(this).show();
                    }
                });
            }
        });
    </script>
</body>
</html>
